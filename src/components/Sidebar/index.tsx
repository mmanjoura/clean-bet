"use client";

import React, { useEffect, useRef, useState } from "react";
import { usePathname } from "next/navigation";
import Link from "next/link";
import Image from "next/image";
import SidebarItem from "@/components/Sidebar/SidebarItem";
import ClickOutside from "@/components/ClickOutside";
import useLocalStorage from "@/hooks/useLocalStorage";

interface SidebarProps {
  sidebarOpen: boolean;
  setSidebarOpen: (arg: boolean) => void;
}

const menuGroups = [
  {
    name: "MENU",
    menuItems: [
      {
        icon: (
      <svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 36 36"><path fill="#292f33" d="M28.721 12.849s3.809 1.643 5.532.449q2.585-1.79 1.159-4.736C34.461 6.601 31.789 5.83 31.7 3.27c0 0-.298 4.141 1.513 5.505c2.562 1.933-.446 4.21-3.522 3.828c-3.078-.382-.97.246-.97.246"/><path fill="#8a4b38" d="M23.875 19.375s-.628 2.542.187 5.03c.145.341.049.556-.208.678c-.256.122-4.294 1.542-4.729 1.771c-.396.208-1.142 1.78-1.208 2.854c.844.218 1.625.104 1.625.104s.025-1.915.208-2.042s5.686-1.048 6.062-1.771s1.611-3.888.812-5.292c-.225-.395-.637-1.15-.637-1.15z"/><path fill="#292f33" d="M17.917 29.708s-.616 1.993.008 2.138c.605.141 1.694-.388 1.755-.646c.081-.343.216-1.179.098-1.366c-.118-.186-1.861-.126-1.861-.126"/><path fill="#8a4b38" d="m11.812 21.875l-.75-2.562s-2.766 2.105-3.938 3.594c-.344.437-1.847 3.198-1.722 4.413c.05.488.474 2.583.474 2.583l1.651-.465s-1.312-1.896-1.021-2.562c1.428-3.263 5.306-5.001 5.306-5.001"/><path fill="#292f33" d="M7.679 29.424c-.172-.139-1.803.479-1.803.479s.057 2.085.695 2.022c.618-.061 1.48-.912 1.455-1.175c-.034-.351-.175-1.187-.347-1.326"/><path fill="#c1694f" d="M27.188 11.188c-3.437.156-7.207.438-9.5.438c-3.655 0-5.219-1.428-6.562-2.625C8.838 6.964 8.167 4.779 6 5.501c0 0-.632-.411-1.247-.778l-.261-.152a7 7 0 0 0-.656-.347c-.164-.072-.258-.087-.228-.01c.019.051.093.143.236.286c.472.472.675.95.728 1.395c-2.01 1.202-2.093 2.276-2.871 3.552c-.492.807-1.36 2.054-1.56 2.515c-.412.948 1.024 2.052 1.706 1.407c.893-.845.961-1.122 2.032-1.744c.983-.016 1.975-.416 2.308-1.02c0 0 .938 2.083 1.938 3.583s2.5 3.125 2.5 3.125c-.131 1.227.12 2.176.549 2.922c-.385.757-.924 1.807-1.417 2.745c-.656 1.245-1.473 3.224-1.208 3.618c.534.798 2.719 2.926 4.137 3.311c1.03.28 2.14.437 2.14.437l-.193-1.574s-1.343.213-1.875-.083c-1.427-.795-2.666-2.248-2.708-2.542c-.07-.487 3.841-2.868 5.14-3.645c2.266.097 6.022-.369 8.626-1.702c.958 1.86 2.978 2.513 2.978 2.513s.667 2.208 1.375 4.125c-1.017.533-4.468 3.254-4.975 3.854c-.456.54-.856 2.49-.856 2.49c.82.375 1.57.187 1.57.187s.039-1.562.385-2.073s4.701-2.559 5.958-3.458c.492-.352.404-.903.262-1.552c-.321-1.471-.97-4.781-.971-4.782c5.146-2.979 6.458-11.316-2.354-10.916"/><path fill="#292f33" d="M22.336 33.782s-.616 1.993.008 2.138c.605.141 1.694-.388 1.755-.646c.081-.343.216-1.179.098-1.366s-1.861-.126-1.861-.126m-7.676-5.296c-.167.146.164 1.859.164 1.859s2.064.299 2.111-.34c.045-.62-.647-1.614-.91-1.634c-.351-.027-1.198-.031-1.365.115"/><path fill="#ffac33" d="M25.103 11.282c-3.295.135-9.103.499-10.4-.079c.063 1.922-.676 3.605.3 6.865c.46.101 8.122.244 10.935-.912c-.672-2.862-.389-3.993-.835-5.874"/><path fill="#623120" d="M15.891 11.438s-.759 3.543 2.408 3.63s2.792-2.247 3.045-2.505s2.718-.391 2.718-1.064c0-.233-1.269-.127-1.874-.099c-.303.014-3.589.204-6.297.038"/><path fill="#5c913b" d="M6.094 5.706c-.682.47-1.67.286-1.67.286c-.594.25-1.524 1.156-1.93 1.937S.969 10.593.969 10.593s1.094.865 1.719 1.906c0 0 .531-.531 1.192-.875c1.942-.063 2.308-1.02 2.308-1.02s.031-2.992-.094-4.898M4.321 8.467a.46.46 0 0 1-.46-.459a.46.46 0 0 1 .919 0a.46.46 0 0 1-.459.459"/><circle cx="4.25" cy="8.047" r=".349" fill="#292f33"/><path fill="#f5f8fa" d="M4.321 7.099a.91.91 0 0 0 0 1.818a.91.91 0 0 0 0-1.818m0 1.368a.46.46 0 0 1-.46-.459a.46.46 0 0 1 .919 0a.46.46 0 0 1-.459.459m-1.785 4.185L.765 10.9l.253-.388l1.841 1.817zm3.568-6.953l.449-.009l.093 4.898l-.449.009z"/><path fill="#292f33" d="M12.655 9.07c1.773 1.446 3.147.322 3.147.322c-1.295-.271-2.056-.867-2.708-1.562c.835-.131 1.287-.666 1.287-.666c-1.061-.013-1.824-.3-2.485-.699c-.565-.614-1.233-1.202-2.254-1.631a5 5 0 0 0-.922-.276c-.086-.025-.178-.063-.258-.073a4.13 4.13 0 0 0-2.737.603c-.322.2-.214.639.117.623c1.741-.085 2.866.582 3.47 1.633c2.169 3.772 5.344 3.875 5.344 3.875s-1.29-.688-2.001-2.149m5.11 13.33l-.361-7.566l1.029.228l.45 7.208c-.377.071-1.118.13-1.118.13"/><path fill="#623120" d="M2.354 12.75a.5.5 0 0 1-.203-.956C8.29 9.058 13.369 9.059 13.628 9.047a.5.5 0 0 1-.003 1h-.004c-.104 0-5.15.025-11.063 2.66a.5.5 0 0 1-.204.043"/><path fill="#7c543e" d="M18.875 5.516c-.438-1.469-3.256-1.231-3.077-2.591l-.121.243a2.2 2.2 0 0 0-.171-.62c-.45-.997-1.522-1.486-2.394-1.092c-.756.341-1.738.349-1.341 1.636c.061.197.134.451.248.703c.452.996 1.849 1.665 2.722 1.271c.05-.022.091-.055.137-.082c.207.123.84.506 1.864 1.205c1.207.823 2.568.797 2.133-.673"/><path fill="#0b0200" d="M11.889 1.419c.256-.5 1.301-1.065 2.192-1.01c1.005.063 1.564.76 1.795 1.633c.114.43.045.914-.043 1.27c0 0-.965-.087-.858-.15c.198-.117.034-.815-.218-.907c-.265-.097-.361.163-.324.364s.032.324-.08.398s-.489-.502-.765-.614c-.455-.185-1.491 1.132-1.816.69c-.202-.276-.2-1.055.117-1.674"/><path fill="#9266cc" d="M13.163 2.849s1.582-.754 1.988-.869s.603-.166.671-.252c.067-.086-.103-.225-.178-.316s-.44-.974-1.275-1.243c-.696-.224-1.202-.111-1.583.045s-1.184.512-1.366 1.842c-.096.745.038 1.145.038 1.145s-.476.136-.523.144s-.042.126.179.181s1.292-.068 1.64-.231s.318-.371.409-.446"/><path d="M20.828 14.172c-.186-.532-.248-.716-.554-1.524c-.1-.264-.219-.585-.369-.993l-1.934.745c.176.383.313.688.426.946c.364.832.475 1.321.592 1.877l-.801.291c-.387.168-.811.333-.858.933c-.036.462.341.424.635.388c.433-.052 3.093-.506 3.223-.788c.117-.257-.139-1.243-.36-1.875"/><path fill="#ccd6dd" d="M17.971 12.4s-.2-.506-.395-1.169c-.376-1.282-.565-2.314 3.451-3.335a2 2 0 0 0-.099-.152c-1.324-1.858-4.253-3.696-3.491-3.815c3.832-.601 5.007-.007 6.684 2.349c.827 1.162.936 1.593.784 2.191c-.59 2.328-5.15 1.272-5 3.186z"/><path fill="#5c913b" d="M17.439 7.086c1.535 1.055 2.339-.154 3.588.81l3.277-1.322c-1.281-2.465-4.879-4.553-7.86-3.024c-.693.355-1.185 1.024-1.041 1.804c.289 1.56 1.405 1.299 2.036 1.732"/><path fill="#a6d388" d="M17.937 5.153c-.031-.08-.117-.287-.179-.356c-.3-.419-.842-.609-1.34-.406a1.14 1.14 0 0 0-.626 1.487c.924 2.413 1.142 2.651 1.032 2.839c-.03.03-.348.284-2.323.09L14 9v1l.305.797c1.924.189 3.359.114 4.107-.865c.879-1.152.428-2.421-.475-4.779"/><path fill="#7c543e" d="M14.502 8.807c-1.893-1.191-2.035.25-2.089.799c-.054.55-.098.995 1.893 1.191z"/><path fill="#aab8c2" d="m18.273 15.478l.447-.159c-.488-1.218-1.031-1.021-1.071-1.006c-.2.076-.925 1.053-.316 2.516a.25.25 0 1 0 .462-.192c-.373-.896-.142-1.651.031-1.725c.172-.073.411.302.447.566"/></svg>
        ),
        label: "Horse Racing",
        route: "#",
        children: [
          { label: "UK & Ireland", route: "/racing/meetings" },
          { label: "France", route: "/racing/stats" },
          { label: "Strike Rate", route: "/racing/stats" },
        ],
      },
      {
      icon: (
        <svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 50 50"><g fill="none" strokeLinecap="round" strokeLinejoin="round" strokeWidth="2"><path stroke="#344054" d="M20.146 6.896L25 10.416l4.854-3.52M6.292 24.02l4.833-3.52l-1.833-5.708M37.5 37.5l-4-.083l-1.52 4.958M12.5 37.5l4-.083l1.52 4.958m22.71-27.583L38.874 20.5l4.833 3.52M25 16.667v-6.25zm-7.48 5.52L11.126 20.5zm2.98 9.063l-4.062 6.25zm9 0l4.063 6.25zm2.792-9.02l6.583-1.73zM25 16.666l-7.292 5.562L20.5 31.25h9l2.792-9.02z"/><path stroke="#306cfe" d="M25 43.75c10.355 0 18.75-8.395 18.75-18.75S35.355 6.25 25 6.25S6.25 14.645 6.25 25S14.645 43.75 25 43.75"/></g></svg>  ),
        label: "Football",
        route: "#",
        children: [
          { label: "Premier League", route: "/football/leagues" },
          { label: "French Ligue 1", route: "/football/stats" },
          { label: "Spanish Liga Nacional", route: "/football/stats" },
        ],
      },
      {
        icon: (
          <svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 64 64"><path fill="#db7c27" d="M51.649 17.06c-.04-.048-.073-.1-.108-.148C46.33 10.173 39.649 5.541 32.925 3.401C26.545 1.006 18.577-.132 9.543 2.53c0 0-8.382 10.09-4.532 27.12c.719 3.871 2.134 7.813 4.237 11.623q.636 1.273 1.366 2.584l.131-.1a43 43 0 0 0 2.138 3.034l.115.144c.039.049.071.098.11.149c5.207 6.736 11.891 11.369 18.615 13.512c6.377 2.393 14.347 3.532 23.372.869c0 0 8.386-10.09 4.531-27.12c-.72-3.862-2.133-7.816-4.235-11.623a66 66 0 0 0-1.366-2.583l-.128.101a44 44 0 0 0-2.141-3.039c-.04-.044-.075-.091-.114-.139"/><g fill="#25333a"><path d="M13.292 9.75s6.99 17.744 37.31 48.268l1.025-.79S15.372 18.217 14.508 8.804"/><path d="M23.53 34.181c3.551-1.812 7.565-3.766 9.808-7.203c1.239-1.9-1.442-3.85-2.693-1.925c-1.904 2.915-5.288 4.498-8.298 6.037c-2.05 1.045-.87 4.14 1.184 3.091m3.552 6.079c3.795-2.352 7.772-5.025 9.87-9.04c1.047-2.02-2.126-3.153-3.173-1.139c-1.752 3.363-5.553 5.62-8.708 7.578c-1.964 1.216.069 3.805 2.012 2.601m3.559 4.319c3.822-2.026 7.52-4.6 9.929-8.242c1.255-1.893-1.428-3.84-2.693-1.925c-2.06 3.117-5.14 5.335-8.423 7.074c-2.027 1.078-.851 4.174 1.187 3.093m-8.251-15.837c2.33-1.496 4.543-3.037 6.45-5.058c1.582-1.678-1.123-3.594-2.696-1.924c-1.66 1.76-3.737 3.08-5.762 4.381c-1.95 1.248.08 3.84 2.008 2.601m14.586 18.463c2.224-1.279 4.448-2.83 5.862-5c1.238-1.901-1.442-3.85-2.696-1.926c-1.06 1.63-2.666 2.866-4.351 3.834c-.845.487-1.396 1.345-1.045 2.258c.293.766 1.38 1.324 2.23.834"/></g></svg>  ),
        label: "Rugby",
        route: "#",
        children: [
          { label: "English", route: "/football/leagues" },
          { label: "Irish", route: "/football/stats" },
          { label: "Scottish", route: "/football/stats" },
          { label: "French", route: "/football/stats" },
          { label: "Welsh", route: "/football/stats" },
        ],
      },
    ],
  
  },
  {
    name: "OTHERS",
    menuItems: [
      {
        icon: (
          <svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 50 50"><g fill="none" strokeLinecap="round" strokeLinejoin="round"><path stroke="#344054" strokeWidth="2" d="M33.333 18.75L25 31.25"/><path stroke="#344054" strokeWidth="3" d="M25 31.208v.209"/><path stroke="#306cfe" strokeWidth="2" d="M43.75 27.083a18.75 18.75 0 0 1-7 14.584h-23.5a18.75 18.75 0 1 1 30.5-14.584"/></g></svg>
        ),
        label: "Dashboard",
        route: "#",
        children: [{ label: "eCommerce", route: "/" }],
      },
      {
        icon: (
          <svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 24 24"><path fill="currentColor" fillRule="evenodd" d="M8 7a4 4 0 1 1 8 0a4 4 0 0 1-8 0m0 6a5 5 0 0 0-5 5a3 3 0 0 0 3 3h12a3 3 0 0 0 3-3a5 5 0 0 0-5-5z" clipRule="evenodd"/></svg>
        ),
        label: "Profile",
        route: "/profile",
      },
      {
        icon: (
          <svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 50 50"><g fill="none" strokeLinecap="round" strokeLinejoin="round" strokeWidth="2"><path stroke="#344054" d="M25 31.25a6.25 6.25 0 1 0 0-12.5a6.25 6.25 0 0 0 0 12.5"/><path stroke="#306cfe" d="M41.667 20.833h-1.23a2.08 2.08 0 0 1-1.958-1.395a2.08 2.08 0 0 1 .417-2.375l.854-.855a2.08 2.08 0 0 0 0-2.958l-2.958-2.98a2.084 2.084 0 0 0-2.959 0l-.854.855a2.08 2.08 0 0 1-2.375.417a2.08 2.08 0 0 1-1.437-1.98V8.334a2.083 2.083 0 0 0-2.084-2.083h-4.166a2.083 2.083 0 0 0-2.084 2.083v1.23a2.08 2.08 0 0 1-1.395 1.958v0a2.08 2.08 0 0 1-2.375-.417l-.855-.854a2.08 2.08 0 0 0-2.958 0l-2.98 2.958a2.084 2.084 0 0 0 0 2.959l.855.854a2.08 2.08 0 0 1 .417 2.375a2.08 2.08 0 0 1-1.959 1.396h-1.25a2.083 2.083 0 0 0-2.083 2.083v4.167a2.083 2.083 0 0 0 2.083 2.083h1.23a2.08 2.08 0 0 1 1.958 1.396v0a2.08 2.08 0 0 1-.417 2.375l-.854.854a2.083 2.083 0 0 0 0 2.958l2.938 2.938a2.084 2.084 0 0 0 2.958 0l.854-.854a2.08 2.08 0 0 1 2.375-.417a2.08 2.08 0 0 1 1.396 1.958v1.334a2.083 2.083 0 0 0 2.083 2.083h4.167a2.083 2.083 0 0 0 2.083-2.083v-1.23A2.08 2.08 0 0 1 30.5 38.48a2.08 2.08 0 0 1 2.375.417l.854.854a2.08 2.08 0 0 0 2.959 0l2.937-2.937a2.08 2.08 0 0 0 0-2.959L38.771 33a2.08 2.08 0 0 1-.417-2.375v0a2.08 2.08 0 0 1 1.959-1.396h1.354a2.083 2.083 0 0 0 2.083-2.083v-4.23a2.083 2.083 0 0 0-2.083-2.083"/></g></svg>
        ),
        label: "Settings",
        route: "/settings",
      },
      {
        icon: (
          <svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 32 32"><path fill="currentColor" d="m11 23.18l-2-2.001l-1.411 1.41L11 26l6-6l-1.41-1.41zM28 30h-4v-2h4V16h-4V8a4.005 4.005 0 0 0-4-4V2a6.007 6.007 0 0 1 6 6v6h2a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2"/><path fill="currentColor" d="M20 14h-2V8A6 6 0 0 0 6 8v6H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V16a2 2 0 0 0-2-2M8 8a4 4 0 0 1 8 0v6H8Zm12 20H4V16h16Z"/></svg>
        ),
        label: "Authentication",
        route: "#",
        children: [
          { label: "Sign In", route: "/auth/signin" },
          { label: "Sign Up", route: "/auth/signup" },
        ],
      },
    ],

 
  },
];

const Sidebar = ({ sidebarOpen, setSidebarOpen }: SidebarProps) => {
  const pathname = usePathname();
  const [pageName, setPageName] = useLocalStorage("selectedMenu", "dashboard");

  return (
    <ClickOutside onClick={() => setSidebarOpen(false)}>
      <aside
        className={`fixed left-0 top-0 z-9999 flex h-screen w-72.5 flex-col overflow-y-hidden bg-black duration-300 ease-linear dark:bg-boxdark lg:translate-x-0 ${
          sidebarOpen ? "translate-x-0" : "-translate-x-full"
        }`}
      >
        {/* <!-- SIDEBAR HEADER --> */}
        <div className="flex items-center justify-between gap-2 px-6 py-5.5 lg:py-6.5">
          <Link href="/">
            <Image
              width={126}
              height={2}
              src={"/images/logo/logo-transparent-svg.svg"}
              alt="Logo"
              priority
            />
          </Link>

          <button
            onClick={() => setSidebarOpen(!sidebarOpen)}
            aria-controls="sidebar"
            className="block lg:hidden"
          >
            <svg
              className="fill-current"
              width="20"
              height="18"
              viewBox="0 0 20 18"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M19 8.175H2.98748L9.36248 1.6875C9.69998 1.35 9.69998 0.825 9.36248 0.4875C9.02498 0.15 8.49998 0.15 8.16248 0.4875L0.399976 8.3625C0.0624756 8.7 0.0624756 9.225 0.399976 9.5625L8.16248 17.4375C8.31248 17.5875 8.53748 17.7 8.76248 17.7C8.98748 17.7 9.17498 17.625 9.36248 17.475C9.69998 17.1375 9.69998 16.6125 9.36248 16.275L3.02498 9.8625H19C19.45 9.8625 19.825 9.4875 19.825 9.0375C19.825 8.55 19.45 8.175 19 8.175Z"
                fill=""
              />
            </svg>
          </button>
        </div>
        {/* <!-- SIDEBAR HEADER --> */}

        <div className="no-scrollbar flex flex-col overflow-y-auto duration-300 ease-linear">
          {/* <!-- Sidebar Menu --> */}
          <nav className="mt-5 px-4 py-4 lg:mt-9 lg:px-6">
            {menuGroups.map((group, groupIndex) => (
              <div key={groupIndex}>
                <h3 className="mb-4 ml-4 text-sm font-semibold text-bodydark2">
                  {group.name}
                </h3>

                <ul className="mb-6 flex flex-col gap-1.5">
                  {group.menuItems.map((menuItem, menuIndex) => (
                    <SidebarItem
                      key={menuIndex}
                      item={menuItem}
                      pageName={pageName}
                      setPageName={setPageName}
                    />
                  ))}
                </ul>
              </div>
            ))}
          </nav>
          {/* <!-- Sidebar Menu --> */}
        </div>
      </aside>
    </ClickOutside>
  );
};

export default Sidebar;
